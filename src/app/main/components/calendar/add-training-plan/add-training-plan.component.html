<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button></ion-back-button>
    </ion-buttons>
    <ion-title>Wähle Übungen</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="saveTrainingPlan()">
        <ion-icon [size]="'large'" name="checkmark"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>
<ion-content class="ion-padding">


  <ion-accordion-group>

    <ion-accordion *ngFor="let day of weekDays; let i = index" [value]="day" toggleIconSlot="start">
      <ion-item slot="header">
        <ion-label>{{day}}</ion-label>
        <ion-icon *ngIf="!exercises[i] || exercises[i].length < 1" name="time" slot="end" color="warning"></ion-icon>
        <ion-buttons>
          <ion-button (click)="addExercise(i)" click-stop-propagation>
            <ion-icon color="success" size="large" name="add"></ion-icon>
          </ion-button>
        </ion-buttons>
      </ion-item>

      <div class="ion-padding" slot="content">
        <ion-accordion-group class="exercise">
          <ion-accordion *ngFor="let exercise of exercises[i]; let j = index" class="ion-margin-bottom" toggleIconSlot="start">

            <div slot="header">
              <ion-item lines="none" [class.autocomplete-search]="searchFocus[i][j]">
                <ion-icon class="ion-accordion-toggle-icon" slot="start" name="chevron-down"></ion-icon>
                <ion-input [(ngModel)]="exercise.name" (ngModelChange)="searchExercises($event, i, j); onFocus(i, j)" placeholder="Name der Übung" id="click-trigger" (ionFocus)="onFocus(i,j)" (ionBlur)="onBlur(i,j)" click-stop-propagation></ion-input>
                <ion-icon name="trash" slot="end" color="danger" (click)="removeExercise(i, j)"></ion-icon>
              </ion-item>

              <div *ngIf="searchFocus[i][j]" class="autocomplete-list">
                <ion-list *ngIf="searchResults.length > 0">
                  <ion-item *ngFor="let exercise of searchResults" (click)="setExercise(i, j, exercise)" click-stop-propagation>
                    <ion-label>{{exercise.name}}</ion-label>
                    <ion-note *ngIf="exercise.id" slot="end">Letzter Stand</ion-note>
                  </ion-item>
                </ion-list>
              </div>
            </div>



            <div slot="content" class="ion-padding-start ion-padding-end">
              <input-field [(model)]="exercise.reps" label="Wiederholungen"></input-field>
              <input-field [(model)]="exercise.sets" label="Sätze"></input-field>

              <label class="ion-padding-horizontal ion-padding-top h5">
                Gewicht
                <ion-note>(optional)</ion-note>
              </label>
              <ion-item class="ion-margin-bottom">
                <ion-input
                  placeholder="Daten eingeben..."
                  [inputmode]="'decimal'"
                  [type]="'number'"
                  [min]="0"
                  [(ngModel)]="exercise.weight">
                </ion-input>
                <ion-text slot="end">kg</ion-text>
              </ion-item>
            </div>
          </ion-accordion>
        </ion-accordion-group>
      </div>

    </ion-accordion>

  </ion-accordion-group>

</ion-content>
